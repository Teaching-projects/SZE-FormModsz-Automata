<?xml version="1.0" encoding="utf-8"?><!DOCTYPE nta PUBLIC '-//Uppaal Team//DTD Flat System 1.1//EN' 'http://www.it.uu.se/research/group/darts/uppaal/flat-1_1.dtd'><nta><declaration>// Place global declarations here.
chan coin, coffe, tea, refund, ready, empty, money;
int coins_back = 0;

bool reserved;

</declaration><template><name x="5" y="5">CoffeMachine</name><declaration>// Place local declarations here.
int coffe_nr = 3, tea_nr = 3, coins_in = 0;

clock seconds;</declaration><location id="id0" x="328" y="48"><name x="288" y="64">Coins_waiting</name><label kind="invariant" x="344" y="40">seconds &lt; 10</label></location><location id="id1" x="144" y="-168"><name x="134" y="-198">Reload_tea</name></location><location id="id2" x="-136" y="-168"><name x="-216" y="-200">Reload_coffe</name></location><location id="id3" x="352" y="256"><name x="240" y="248">Tea_preparing</name><label kind="invariant" x="312" y="272">seconds&lt;20</label></location><location id="id4" x="-112" y="448"><name x="-224" y="424">Coffe_preparing</name><label kind="invariant" x="-152" y="464">seconds&lt;30</label></location><location id="id5" x="352" y="160"><name x="342" y="130">Tea_pushed</name></location><location id="id6" x="16" y="448"><name x="40" y="440">Coffe_pushed</name></location><location id="id7" x="16" y="96"><name x="-8" y="64">Coin_in</name></location><location id="id8" x="16" y="-40"><name x="8" y="-80">Init</name></location><init ref="id8"/><transition><source ref="id0"/><target ref="id8"/><label kind="synchronisation" x="216" y="-32">money!</label><label kind="assignment" x="216" y="-16">reserved = 0,
seconds = 0</label></transition><transition><source ref="id7"/><target ref="id0"/><label kind="synchronisation" x="120" y="56">refund?</label><label kind="assignment" x="120" y="72">coins_back = coins_in,
coins_in = 0</label></transition><transition><source ref="id6"/><target ref="id7"/><label kind="guard" x="-176" y="256">coffe_nr == 0</label><label kind="synchronisation" x="-128" y="280">empty!</label><nail x="-96" y="256"/></transition><transition><source ref="id7"/><target ref="id7"/><label kind="synchronisation" x="-192" y="48">coin?</label><label kind="assignment" x="-192" y="64">coins_in ++</label><nail x="-112" y="40"/><nail x="-112" y="160"/></transition><transition><source ref="id1"/><target ref="id8"/><label kind="assignment" x="152" y="-120">tea_nr = 3</label><nail x="152" y="-72"/></transition><transition><source ref="id8"/><target ref="id1"/><label kind="guard" x="40" y="-168">tea_nr == 0</label><label kind="assignment" x="40" y="-152">coins_back = 0</label></transition><transition><source ref="id2"/><target ref="id8"/><label kind="assignment" x="-208" y="-120">coffe_nr = 3</label><nail x="-120" y="-64"/></transition><transition><source ref="id8"/><target ref="id2"/><label kind="guard" x="-104" y="-168">coffe_nr == 0</label><label kind="assignment" x="-96" y="-152">coins_back = 0</label></transition><transition><source ref="id4"/><target ref="id8"/><label kind="guard" x="-352" y="208">seconds &gt;= 10</label><label kind="synchronisation" x="-296" y="-40">ready!</label><label kind="assignment" x="-296" y="-24">coffe_nr --,
coins_back = coins_in,
coins_in = 0,
reserved = 0,
seconds = 0</label><nail x="-360" y="448"/><nail x="-360" y="-40"/></transition><transition><source ref="id7"/><target ref="id6"/><label kind="guard" x="24" y="264">coins_in &gt;= 2</label><label kind="synchronisation" x="24" y="296">coffe?</label></transition><transition><source ref="id3"/><target ref="id8"/><label kind="guard" x="680" y="88">seconds &gt;= 10</label><label kind="synchronisation" x="496" y="-40">ready!</label><label kind="assignment" x="496" y="-24">tea_nr --,
coins_back = coins_in,
coins_in = 0,
reserved = 0,
seconds = 0</label><nail x="664" y="256"/><nail x="664" y="-40"/></transition><transition><source ref="id5"/><target ref="id7"/><label kind="guard" x="48" y="152">tea_nr == 0</label><label kind="synchronisation" x="48" y="168">empty!</label><nail x="32" y="152"/></transition><transition><source ref="id5"/><target ref="id3"/><label kind="guard" x="264" y="184">tea_nr != 0</label><label kind="assignment" x="264" y="200">coins_in -= 1</label></transition><transition><source ref="id6"/><target ref="id4"/><label kind="guard" x="-88" y="424">coffe_nr != 0</label><label kind="assignment" x="-88" y="448">coins_in -= 2</label></transition><transition><source ref="id7"/><target ref="id5"/><label kind="guard" x="208" y="112">coins_in &gt;= 1</label><label kind="synchronisation" x="272" y="128">tea?</label></transition><transition><source ref="id8"/><target ref="id7"/><label kind="synchronisation" x="-24" y="-16">coin?</label><label kind="assignment" x="-64" y="0">coins_in ++,
reserved = 1</label></transition></template><template><name>Customer</name><declaration>int blood_pressure = 110, coins = 4;
</declaration><location id="id9" x="-104" y="-128"><name x="-88" y="-136">Refund_wait</name></location><location id="id10" x="208" y="384"><name x="232" y="368">Cardiologist</name><urgent/></location><location id="id11" x="-312" y="384"><name x="-352" y="400">Drink_ready</name></location><location id="id12" x="-144" y="88"><name x="-120" y="80">Tea_pushed</name></location><location id="id13" x="-480" y="208"><name x="-584" y="200">Coffe_pushed</name></location><location id="id14" x="-312" y="-48"><name x="-344" y="-96">Coin_in</name></location><location id="id15" x="-312" y="-208"><name x="-322" y="-238">Init</name></location><init ref="id15"/><transition><source ref="id9"/><target ref="id15"/><label kind="synchronisation" x="-232" y="-192">money?</label><label kind="assignment" x="-176" y="-192">coins += coins_back,
coins_back = 0</label></transition><transition><source ref="id14"/><target ref="id9"/><label kind="synchronisation" x="-208" y="-128">refund!</label></transition><transition><source ref="id14"/><target ref="id14"/><label kind="guard" x="-576" y="-144">coins &gt; 0</label><label kind="synchronisation" x="-552" y="-160">coin!</label><label kind="assignment" x="-568" y="-128">coins --</label><nail x="-512" y="-176"/><nail x="-512" y="-32"/></transition><transition><source ref="id13"/><target ref="id14"/><label kind="synchronisation" x="-400" y="208">empty?</label><label kind="assignment" x="-400" y="224">blood_pressure += 25</label><nail x="-312" y="208"/></transition><transition><source ref="id10"/><target ref="id15"/><label kind="guard" x="144" y="64">!reserved</label><label kind="assignment" x="144" y="32">coins = 0,
blood_pressure = 110</label><nail x="216" y="-208"/></transition><transition><source ref="id12"/><target ref="id11"/><label kind="synchronisation" x="-136" y="160">ready?</label><label kind="assignment" x="-136" y="184">coins += coins_back,
coins_back = 0</label><nail x="-144" y="272"/></transition><transition><source ref="id14"/><target ref="id13"/><label kind="synchronisation" x="-456" y="56">coffe!</label></transition><transition><source ref="id12"/><target ref="id14"/><label kind="synchronisation" x="-192" y="-32">empty?</label><label kind="assignment" x="-216" y="-72">blood_pressure += 25</label><nail x="-144" y="-48"/></transition><transition><source ref="id13"/><target ref="id11"/><label kind="synchronisation" x="-480" y="264">ready?</label><label kind="assignment" x="-560" y="280">blood_pressure += 20,
coins += coins_back,
coins_back = 0</label></transition><transition><source ref="id11"/><target ref="id10"/><label kind="guard" x="-184" y="360">blood_pressure &gt; 150</label><label kind="assignment" x="-184" y="392">coins += coins_back,
coins_back = 0</label></transition><transition><source ref="id11"/><target ref="id15"/><label kind="guard" x="-744" y="360">blood_pressure &lt;= 150 and !reserved</label><nail x="-808" y="384"/><nail x="-808" y="-208"/></transition><transition><source ref="id14"/><target ref="id12"/><label kind="synchronisation" x="-272" y="-32">tea!</label></transition><transition><source ref="id15"/><target ref="id14"/><label kind="guard" x="-376" y="-144">coins &gt; 0 and !reserved</label><label kind="synchronisation" x="-376" y="-160">coin!</label><label kind="assignment" x="-376" y="-128">coins --</label></transition></template><system>// Place template instantiations here.
Machine = CoffeMachine();
Zoli = Customer();
Sanyi = Customer();

// List one or more processes to be composed into a system.
system Machine, Zoli, Sanyi;</system></nta>